"use strict";(self.webpackChunknest_rental=self.webpackChunknest_rental||[]).push([[372],{69141:function(e,t,n){var i=n(29439),r=n(72791),l=n(24518),o=n(64554),a=n(20890),d=n(13400),s=n(71715),c=n(66934),u=n(68036),p=n(74934),h=n(80184),v=(0,c.ZP)(l.Z)((function(e){var t=e.theme;return"\n     background: ".concat(t.colors.error.main,";\n     color: ").concat(t.palette.error.contrastText,";\n\n     &:hover {\n        background: ").concat(t.colors.error.dark,";\n     }\n    ")}));t.Z=function(){var e=(0,r.useState)(!1),t=(0,i.Z)(e,2),n=t[0],l=t[1],c=(0,r.useRef)(null);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(o.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,h.jsxs)(o.Z,{display:"flex",alignItems:"center",children:[(0,h.jsx)(a.Z,{variant:"h5",color:"text.secondary",children:"A\xe7\xf5es:"}),(0,h.jsx)(v,{sx:{ml:1},startIcon:(0,h.jsx)(u.Z,{}),variant:"contained",children:"Excluir"})]}),(0,h.jsx)(d.Z,{color:"primary",onClick:function(){l(!0)},ref:c,sx:{ml:2,p:1},children:(0,h.jsx)(p.Z,{})})]}),(0,h.jsx)(s.Z,{keepMounted:!0,anchorEl:c.current,open:n,onClose:function(){l(!1)},anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"}})]})}},17596:function(e,t,n){n.r(t),n.d(t,{default:function(){return X}});var i=n(6907),r=n(29439),l=n(61889),o=n(20890),a=n(72791),d=n(91183),s=n(5167),c=n(16871),u=n(80184);var p=function(){var e=(0,a.useContext)(s.S).usuario,t=((0,c.TH)().pathname,a.useState(!1)),n=(0,r.Z)(t,2),i=n[0],p=n[1];return(0,u.jsxs)(l.ZP,{container:!0,justifyContent:"space-between",alignItems:"center",children:[(0,u.jsxs)(l.ZP,{item:!0,children:[(0,u.jsx)(o.Z,{variant:"h3",component:"h3",gutterBottom:!0,children:"Devolu\xe7\xf5es"}),(0,u.jsx)(o.Z,{variant:"subtitle2",children:1===(null===e||void 0===e?void 0:e.id_perfil)||3===(null===e||void 0===e?void 0:e.id_perfil)?(0,u.jsx)("label",{children:"Gerencie as devolu\xe7\xf5es de seus produtos."}):(0,u.jsx)("label",{children:"Realize a devolu\xe7\xe3o de seus pedidos."})})]}),(0,u.jsx)(d.F,{setModal:p,openModal:i,data:"",edit:!1})]})},h=n(68418),v=n(91614),x=n(74165),f=n(15861),j=n(57621),m=n(5229),Z=n(93433),g=n(13967),y=n(64554),b=n(9585),_=n(68096),w=n(94721),C=n(39281),S=n(79836),k=n(56890),z=n(35855),D=n(53994),P=n(53382),W=n(94454),T=n(70493),A=n(13400),M=n(97513),I=n(34045),E=n(31675),B=n(69141),F=n(56355),L=n(72426),R=n.n(L),q=n(39126),N=n(98243),O=n(78820),V=n(88315),G=n(23853),H=n(39709),U=n(97438),Y=n(24518),$=function(e){var t,n,i,l,o,d,c,p,h,v=e.openModal,j=e.setModal,Z=e.data,g=(e.edit,a.useState()),y=(0,r.Z)(g,2),b=y[0],_=y[1],w=a.useState(!1),C=(0,r.Z)(w,2),S=C[0],k=C[1],z=a.useState(""),D=(0,r.Z)(z,2),P=D[0],W=D[1],T=a.useState(null),A=(0,r.Z)(T,2),M=A[0],I=A[1],E=a.useState(""),B=(0,r.Z)(E,2),F=B[0],L=B[1],R=a.useState(""),q=(0,r.Z)(R,2),$=q[0],J=q[1],K=a.useState(""),Q=(0,r.Z)(K,2),X=Q[0],ee=Q[1],te=a.useState(null),ne=(0,r.Z)(te,2),ie=ne[0],re=ne[1],le=a.useState(null),oe=(0,r.Z)(le,2),ae=oe[0],de=oe[1],se=a.useState([]),ce=(0,r.Z)(se,2),ue=ce[0],pe=ce[1],he=(0,a.useContext)(s.S).usuario;function ve(e){var t=new Date(e),n=""+(t.getMonth()+1),i=""+t.getDate(),r=t.getFullYear();return n.length<2&&(n="0"+n),i.length<2&&(i="0"+i),[i,n,r].join("-")}function xe(){return(xe=(0,f.Z)((0,x.Z)().mark((function e(t){var n,i,r;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),k(!0),(n=new FormData).append("status",b),n.append("data_inicio",new Date(Z[0].data_inicio).toISOString().slice(0,19).replace("T"," ")),n.append("data_devolucao",new Date(Z[0].data_devolucao).toISOString().slice(0,19).replace("T"," ")),i=fetch("https://nestrental.com.br:80/api/devolucoes/".concat(Z[0].id),{method:"PUT",body:n,redirect:"follow"}),e.next=9,i;case 9:return r=e.sent,e.next=12,r.json();case 12:e.sent?(W("Status alterado, atualizando..."),fe()):W("Erro no servidor, tente novamente mais tarde."),setTimeout((function(){window.location.reload()}),2e3),k(!1);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(){return je.apply(this,arguments)}function je(){return(je=(0,f.Z)((0,x.Z)().mark((function e(){return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.Z.put("/pedidos/".concat(M),{status:"encerrado",descricao:F,data_inicio:new Date($).toISOString().slice(0,19).replace("T"," "),data_entrega:new Date(X).toISOString().slice(0,19).replace("T"," "),vr_total:ae,itens:ue,id_usuario:ie}).then((function(e){})).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,a.useEffect)((function(){var e,t,n,i,r,l,o,a;null!=Z&&(I(null===(e=Z[0].pedido)||void 0===e?void 0:e.id),L(null===(t=Z[0].pedido)||void 0===t?void 0:t.descricao),J(null===(n=Z[0].pedido)||void 0===n?void 0:n.data_inicio),ee(null===(i=Z[0].pedido)||void 0===i?void 0:i.data_entrega),de(null===(r=Z[0].pedido)||void 0===r?void 0:r.itens[0].valor),pe(null===(l=Z[0].pedido)||void 0===l?void 0:l.itens),re(null===(o=Z[0].pedido)||void 0===o||null===(a=o.cliente)||void 0===a?void 0:a.id))}),[null!=Z]),(0,u.jsx)(u.Fragment,{children:v&&(0,u.jsx)("div",{className:N.Z.modal,style:{height:"400px"},children:(0,u.jsxs)("div",{className:N.Z.modal__divCloseButton,children:[(0,u.jsx)("button",{className:N.Z.modal__divCloseButton__closeButton,onClick:function(e){return j(!v)},children:(0,u.jsx)(O.LHV,{})}),(0,u.jsxs)("form",{className:N.Z.formCheckout,style:{textAlign:"left"},children:[(0,u.jsx)(V.D,{level:3,children:"Detalhes da devolu\xe7\xe3o"}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gridGap:"1rem",marginTop:"1rem"},children:[(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsx)(U.Z,{id:"name_client",type:"text",label:"Cliente",fullWidth:!0,required:!0,color:"primary",disabled:!0,size:"small",value:null===(t=Z[0])||void 0===t?void 0:t.pedido.cliente.razao_social})}),(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsx)(U.Z,{id:"email_client",type:"text",disabled:!0,label:"Email",size:"small",fullWidth:!0,required:!0,color:"primary",value:null===(n=Z[0])||void 0===n?void 0:n.pedido.cliente.email})})]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gridGap:"1rem",marginTop:"1rem"},children:[(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsx)(U.Z,{id:"product_client",type:"text",disabled:!0,label:"Produto",fullWidth:!0,size:"small",required:!0,color:"primary",value:null===(i=Z[0])||void 0===i||null===(l=i.pedido.itens[0])||void 0===l?void 0:l.produto.nome})}),(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsx)(U.Z,{id:"valor_product",type:"text",disabled:!0,label:"Valor R$",fullWidth:!0,required:!0,color:"primary",size:"small",value:null!==(o=Z[0])&&void 0!==o&&o.pedido.itens[0].valor?null===(d=Z[0])||void 0===d?void 0:d.pedido.itens[0].valor.toLocaleString("pt-br",{style:"currency",currency:"BRL"}):null})})]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gridGap:"1rem",marginTop:"1rem"},children:[(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsx)(U.Z,{id:"date_begin_rent",type:"text",label:"In\xedcio",disabled:!0,fullWidth:!0,size:"small",required:!0,color:"primary",value:ve(null===(c=Z[0])||void 0===c?void 0:c.data_inicio)})}),(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsx)(U.Z,{id:"date_rend_rent",type:"text",label:"Devolu\xe7\xe3o",fullWidth:!0,required:!0,size:"small",disabled:!0,color:"primary",value:ve(null===(p=Z[0])||void 0===p?void 0:p.data_devolucao)})})]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gridGap:"2rem",marginTop:".5rem"},children:[1===(null===he||void 0===he?void 0:he.id_perfil)||3===(null===he||void 0===he?void 0:he.id_perfil)?(0,u.jsxs)("div",{style:{width:"25%"},children:[(0,u.jsx)("label",{htmlFor:"start",style:{display:"block",paddingTop:"1rem"},children:"Status da devolu\xe7\xe3o"}),(0,u.jsxs)("select",{onChange:function(e){return function(e){_(e.target.value)}(e)},disabled:"E"===Z[0].status,style:{width:"100%",padding:".7rem",borderRadius:"8px",border:"1px solid #9099A9"},children:[(0,u.jsx)("option",{value:"A",selected:"A"!==Z[0].status,children:"Pendente"}),(0,u.jsx)("option",{value:"E",selected:"E"===Z[0].status,children:"Conclu\xeddo"})]})]}):(0,u.jsxs)("div",{style:{width:"25%"},children:[(0,u.jsx)("label",{htmlFor:"start",style:{display:"block",paddingTop:".5rem"},children:"Status da devolu\xe7\xe3o"}),(0,u.jsx)("input",{type:"text",name:"end",value:"A"==(null===(h=Z[0])||void 0===h?void 0:h.status)?"Pendente":"Conclu\xeddo",style:{width:"100%",borderRadius:"10px",border:"1px solid #9099A9",padding:".7rem",color:"#9099A9"},disabled:!0})]}),1===(null===he||void 0===he?void 0:he.id_perfil)||3===(null===he||void 0===he?void 0:he.id_perfil)?(0,u.jsxs)("div",{style:{width:"100%"},children:[(0,u.jsx)("label",{htmlFor:"start",style:{display:"block",paddingTop:"1rem"},children:"Documento anexado"}),(0,u.jsxs)(Y.Z,{color:"primary",variant:"outlined",type:"button",size:"medium",onClick:function(e){return function(e){e.preventDefault();var t=document.createElement("a");t.href="https://nestrental.com.br:80".concat(Z[0].anexo),t.setAttribute("download","devolucao.pdf"),t.setAttribute("target","_blank"),document.body.appendChild(t),t.click(),t.parentNode.removeChild(t)}(e)},children:["Download",(0,u.jsx)(G._hL,{size:15})]})]}):(0,u.jsx)(u.Fragment,{})]}),1===(null===he||void 0===he?void 0:he.id_perfil)||3===(null===he||void 0===he?void 0:he.id_perfil)?(0,u.jsxs)("div",{style:{display:"flex",gridGap:"1rem",width:"20rem",marginTop:"1rem"},children:[(0,u.jsx)(H.Z,{type:"submit",color:"primary",variant:"contained",onClick:function(e){return function(e){return xe.apply(this,arguments)}(e)},disabled:"A"!==Z[0].status,children:"Atualizar"}),(0,u.jsx)(H.Z,{type:"button",color:"warning",variant:"contained",onClick:function(e){return j(!v)},disabled:"A"!==Z[0].status,children:"Cancelar"})]}):"",!S&&(0,u.jsx)("p",{style:{color:"green"},children:P})]})]})})})},J=function(e){var t=e.devolutions,n=e.panel,i=(0,a.useState)([]),l=(0,r.Z)(i,2),d=l[0],c=l[1],p=d.length>0,h=(0,a.useState)(0),v=(0,r.Z)(h,2),L=v[0],N=v[1],O=(0,a.useState)(5),V=(0,r.Z)(O,2),G=V[0],H=V[1],U=(0,a.useCallback)((function(){var e=I.P6.json_to_sheet(t),n=I.P6.book_new();I.P6.book_append_sheet(n,e,"Data"),(0,I.Fv)(n,"Devolucao.xlsx")}),[t]),Y=function(e){return e.filter((function(e){return!0}))}(t),J=function(e,t,n){return e.slice(t*n,t*n+n)}(Y,L,G),K=(d.length>0&&(d.length,t.length),d.length,t.length,(0,g.Z)()),Q=(0,a.useState)([]),X=(0,r.Z)(Q,2),ee=X[0],te=X[1],ne=(0,a.useState)([]),ie=(0,r.Z)(ne,2),re=(ie[0],ie[1],(0,a.useState)(!1)),le=(0,r.Z)(re,2),oe=le[0],ae=le[1];function de(e){return se.apply(this,arguments)}function se(){return se=(0,f.Z)((0,x.Z)().mark((function e(t){var n,i;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ae(!oe),te(null),e.next=4,m.Z.get("/devolucoes/devolucao/".concat(t));case 4:n=e.sent,i=n.data,te(i||null);case 7:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}var ce=(0,a.useContext)(s.S).usuario;return(0,u.jsxs)(j.Z,{children:[p&&(0,u.jsx)(y.Z,{flex:1,p:2,children:(0,u.jsx)(B.Z,{})}),!p&&(0,u.jsx)(b.Z,{action:(0,u.jsxs)(y.Z,{width:150,children:[(0,u.jsx)(_.Z,{fullWidth:!0,variant:"outlined"}),!n&&(0,u.jsx)(F.veA,{onClick:U,style:{textAlign:"right",position:"relative",left:"7rem",height:"25px",width:"25px",cursor:"pointer"}})]}),title:"Devolu\xe7\xf5es"}),(0,u.jsx)(w.Z,{}),(0,u.jsx)(C.Z,{children:(0,u.jsxs)(S.Z,{children:[(0,u.jsx)(k.Z,{children:(0,u.jsxs)(z.Z,{children:[(0,u.jsx)(D.Z,{}),(0,u.jsx)(D.Z,{children:"Empresa"}),(0,u.jsx)(D.Z,{children:"Contato"}),(0,u.jsx)(D.Z,{children:"Devolu\xe7\xe3o"}),(0,u.jsx)(D.Z,{align:"right",children:"Valor"}),(0,u.jsx)(D.Z,{align:"right",children:"Status"}),(0,u.jsx)(D.Z,{align:"right",children:"A\xe7\xf5es"})]})}),(0,u.jsx)(P.Z,{children:J.map((function(e){var n,i=d.includes(e.id);return(0,u.jsxs)(z.Z,{hover:!0,selected:i,children:[(0,u.jsx)(D.Z,{padding:"checkbox",children:(0,u.jsx)(W.Z,{color:"primary",checked:i,onChange:function(n){return function(e,n){t.includes(n)?c((function(e){return e.filter((function(e){return e!==n}))})):c((function(e){return[].concat((0,Z.Z)(e),[n])}))}(0,e.id)},value:i})}),(0,u.jsx)(D.Z,{children:(0,u.jsx)(o.Z,{variant:"body1",fontWeight:"bold",color:"text.primary",gutterBottom:!0,noWrap:!0,children:e.pedido.cliente.razao_social})}),(0,u.jsx)(D.Z,{children:(0,u.jsx)(o.Z,{variant:"body1",fontWeight:"bold",color:"text.primary",gutterBottom:!0,noWrap:!0,children:e.pedido.cliente.email})}),(0,u.jsxs)(D.Z,{children:[(0,u.jsx)(o.Z,{variant:"body1",fontWeight:"bold",color:"text.primary",gutterBottom:!0,noWrap:!0,children:R()(e.data_inicio).utc().format("DD/MM/yyyy")}),(0,u.jsx)(o.Z,{variant:"body1",fontWeight:"bold",color:"text.secondary",gutterBottom:!0,noWrap:!0,children:R()(e.data_devolucao).utc().format("DD/MM/yyyy")})]}),(0,u.jsxs)(D.Z,{align:"right",children:[(0,u.jsx)(o.Z,{variant:"body1",fontWeight:"bold",color:"text.primary",gutterBottom:!0,noWrap:!0}),(0,u.jsx)(o.Z,{variant:"body2",color:"text.secondary",noWrap:!0,children:null===(n=Number(e.pedido.vr_total))||void 0===n?void 0:n.toLocaleString("pt-br",{style:"currency",currency:"BRL"})})]}),(0,u.jsx)(D.Z,{align:"right",children:(0,u.jsx)(o.Z,{variant:"body1",fontWeight:"bold",color:"text.primary",gutterBottom:!0,noWrap:!0,children:"A"==e.status?(0,u.jsx)("p",{style:{color:"#EF5B25"},children:"Pendente"}):(0,u.jsx)("p",{style:{color:"green"},children:"Conclu\xeddo"})})}),2===(null===ce||void 0===ce?void 0:ce.id_perfil)||3===(null===ce||void 0===ce?void 0:ce.id_perfil)?(0,u.jsx)(D.Z,{align:"right",children:(0,u.jsx)(T.Z,{title:"Visualizar pedido",arrow:!0,children:(0,u.jsx)(A.Z,{sx:{"&:hover":{background:K.colors.primary.lighter},color:K.palette.primary.main},color:"inherit",size:"small",onClick:function(t){return de(e.id)},children:(0,u.jsx)(q.rCC,{style:{width:"20px",height:"20px"}})})})}):(0,u.jsx)(D.Z,{align:"right",children:(0,u.jsx)(T.Z,{title:"Editar pedido",arrow:!0,children:(0,u.jsx)(A.Z,{sx:{"&:hover":{background:K.colors.primary.lighter},color:K.palette.primary.main},color:"inherit",size:"small",onClick:function(t){return de(null===e||void 0===e?void 0:e.id)},children:(0,u.jsx)(E.Z,{fontSize:"small"})})})})]},e.id)}))})]})}),(0,u.jsx)(y.Z,{p:2,children:(0,u.jsx)(M.Z,{component:"div",count:Y.length,onPageChange:function(e,t){N(t)},onRowsPerPageChange:function(e){H(parseInt(e.target.value))},page:L,rowsPerPage:G,rowsPerPageOptions:[5,10,25,30]})}),ee&&oe&&(0,u.jsx)($,{openModal:oe,setModal:ae,data:ee,edit:!0})]})};J.defaultProps={devolutions:[]};var K=J;var Q=function(){var e=(0,a.useState)([]),t=(0,r.Z)(e,2),n=t[0],i=t[1],l=a.useContext(s.S).usuario;function o(){return(o=(0,f.Z)((0,x.Z)().mark((function e(){var t,n,r,o;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==(null===l||void 0===l?void 0:l.id_perfil)&&3!==(null===l||void 0===l?void 0:l.id_perfil)){e.next=8;break}return e.next=3,m.Z.get("/devolucoes");case 3:t=e.sent,n=t.data,i(n),e.next=14;break;case 8:if(2!==(null===l||void 0===l?void 0:l.id_perfil)){e.next=14;break}return e.next=11,m.Z.get("/devolucoes/".concat(null===l||void 0===l?void 0:l.id));case 11:r=e.sent,o=r.data,i(o);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,a.useEffect)((function(){!function(){o.apply(this,arguments)}()}),[]),(0,u.jsx)(j.Z,{children:n&&(0,u.jsx)(K,{devolutions:n||[],panel:!0,className:""})})};var X=function(){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i.ql,{children:(0,u.jsx)("title",{children:"Vendas - Pedidos"})}),(0,u.jsx)(h.Z,{children:(0,u.jsx)(p,{})}),(0,u.jsx)(v.Z,{maxWidth:"lg",children:(0,u.jsx)(l.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"stretch",spacing:3,children:(0,u.jsx)(l.ZP,{item:!0,xs:12,children:(0,u.jsx)(Q,{})})})})]})}},31675:function(e,t,n){var i=n(95318);t.Z=void 0;var r=i(n(45649)),l=n(80184),o=(0,r.default)([(0,l.jsx)("path",{d:"M5 18.08V19h.92l9.06-9.06-.92-.92z",opacity:".3"},"0"),(0,l.jsx)("path",{d:"M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29s-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83zM3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM5.92 19H5v-.92l9.06-9.06.92.92L5.92 19z"},"1")],"EditTwoTone");t.Z=o}}]);
//# sourceMappingURL=372.bbfa47d6.chunk.js.map